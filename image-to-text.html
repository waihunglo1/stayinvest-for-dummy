<html>

<head>
    <script src='https://cdn.rawgit.com/naptha/tesseract.js/1.0.10/dist/tesseract.js'></script>

    <script type="text/javascript">
        document.onpaste = function (event) {
            var items = (event.clipboardData || event.originalEvent.clipboardData).items;

            Tesseract.recognize(items[items.length - 1].getAsFile()).then(function (result) {
                console.log("recognizeText: result.text:", result.text);
                var commaString = result.text.replace(/^(?=\n)$|^\s*|\s*$|\n\n+/gm, "").replace(/[\n\r]/g, ',');
                document.getElementById("convertedText").value = commaString;
            });

            var blob = items[items.length - 1].getAsFile();
            var reader = new FileReader();
            reader.readAsDataURL(blob);
            reader.onload = function (event) {
                const img1 = document.createElement("img");
                img1.src = event.target.result; // Appending image data to img tag
                document.getElementById('imageDiv1').appendChild(img1);
            }
        }

        function gotoStockCharts() {
            var stockCodes = document.getElementById("convertedText").value;
            console.log("goto", stockCodes);

            const stockChartLink = "snapshots-aa.html?t=SC&o={stockCodes}";
            const tempChartLink = stockChartLink.replace(/{stockCodes}/i, stockCodes);

            window.location = tempChartLink;
        }

        function removeLinesCommaJoin() {
            var tempStr = document.getElementById("convertedText").value;
            var commaString = tempStr.replace(/^(?=\n)$|^\s*|\s*$|\n\n+/gm, "").replace(/[\n\r]/g, ',');
            document.getElementById("convertedText").value = commaString;
        }

    </script>

</head>

<body>
    <textarea cols="20" name="original" rows="10" style="width: 50%;" id="convertedText"></textarea><br/>
    <button onclick="removeLinesCommaJoin()">Clean Data</button>
    <button onclick="gotoStockCharts()">See Charts</button>
    <div id="imageDiv1"></div>
</textarea>


</body>

</html>