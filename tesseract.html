<html>

<head>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/tesseract.js/5.1.0/tesseract.min.js'></script>
    <style>
        .column {
            float: left;
            width: 20%;
            padding: 5px;
        }
    </style>
</head>

<body>

    <div class="row">
        <div class="column">
            <p>Input Image</p>
            <img id="imgInput" style="max-width:500px;">
        </div>
        <div class="column">
            <p>Rotated, Original Color</p>
            <img id="imgOriginal" style="max-width:500px;">
        </div>
        <div class="column">
            <p>Rotated, Grey</p>
            <img id="imgGrey" style="max-width:500px;">
        </div>
        <div class="column">
            <p>Rotated, Binary</p>
            <img id="imgBinary" style="max-width:500px;">
        </div>
    </div>

    <script type="text/javascript">
        const recognizeFunction = async ({ target: { file } }) => {
            const worker = await Tesseract.createWorker("eng", 1, {
                // corePath: '/tesseract-core-simd.wasm.js',
                workerPath: "https://cdnjs.cloudflare.com/ajax/libs/tesseract.js/5.1.0/worker.min.js",
                tessedit_char_whitelist: "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ/' '",
                user_defined_dpi: "300"
            });
            const ret = await worker.recognize(file, { rotateAuto: true }, { imageColor: true, imageGrey: true, imageBinary: true });

            document.getElementById("imgInput").src = URL.createObjectURL(file);
            document.getElementById("imgOriginal").src = ret.data.imageColor;
            document.getElementById("imgGrey").src = ret.data.imageGrey;
            document.getElementById("imgBinary").src = ret.data.imageBinary;

            var cleanTextWithComma = ret.data.text.replace(/^(?=\n)$|^\s*|\s*$|\n\n+/gm, "").replace(/[\n\r| ]/g, ',');
            console.log("recognizeText          : ", ret.data.text);
            console.log("cleanTextWithComma     : ", cleanTextWithComma);
        }

        // paste image to trigger recognize
        document.onpaste = function (event) {
            var items = (event.clipboardData || event.originalEvent.clipboardData).items;
            var uploadFile = items[items.length - 1].getAsFile();
            recognizeFunction(uploadFile);
        }
    </script>

</body>

</html>